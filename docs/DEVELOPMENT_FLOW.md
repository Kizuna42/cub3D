# cub3D 開発ワークフロー

## 1. 目的

本ドキュメントは、macOS と Linux という異なる OS 環境下で「cub3D」プロジェクトを効率的かつ確実に遂行するための開発フローを定義します。全員がこのフローに従うことで、品質の担保、手戻りの防止、スムーズな連携を実現します。

## 2. 開発戦略の概要

本プロジェクトでは、以下のハイブリッド戦略を採用します。

- **開発環境 (macOS):** `minilibx_opengl` を使用し、macOS のネイティブ環境で迅速なコーディング、ビルド、テストを行います。開発効率を最大化することが目的です。
- **検証環境 (Linux on UTM):** 提出先と同じ `minilibx-linux` を使用し、UTM 上の Linux 仮想環境で最終的な動作確認とデバッグを行います。互換性と確実性を担保することが目的です。
- **抽象化レイヤー:** OS 間の差異（キーコード、イベント処理など）を吸収するため、OS 依存コードを `platform/` ディレクトリに隔離します。コアロジック (`src/`) は OS 非依存に保ちます。

## 3. 実装ステップ・フロー

各タスクは、以下のステップに従って進めます。

| ステップ            | アクション    | 実施環境    | 詳細                                                                                                  |
| :------------------ | :------------ | :---------- | :---------------------------------------------------------------------------------------------------- |
| **1. 同期**         | `git pull`    | 共通        | 作業開始前に、必ずリモートリポジトリの最新の変更を取り込みます。                                      |
| **2. 実装**         | コーディング  | macOS       | `PROJECT_PLAN.md` に基づき、`src/` または `platform/macos/` 内のファイルを編集します。                |
| **3. ビルド**       | `make`        | macOS       | macOS 上でコンパイルが通ることを確認します。`-Wall -Wextra -Werror` で警告が出ない状態を目指します。  |
| **4. 動作確認**     | 実行 & テスト | macOS       | 実装した機能が macOS 上で意図通りに動作するか、テスト用の `.cub` ファイルを用いて確認します。         |
| **5. 検証**         | `make` & 実行 | Linux (UTM) | 機能のキリが良いタイミングで Linux 環境でもビルドと動作確認を行い、環境依存の問題がないか検証します。 |
| **6. 品質チェック** | `norminette`  | 共通        | `norminette src/ include/ platform/` を実行し、コードが規範に準拠しているか確認します。               |
| **7. コミット**     | `git commit`  | 共通        | 変更内容を分かりやすいメッセージと共にコミットします。（例: `feat(parser): Implement color parsing`） |
| **8. プッシュ**     | `git push`    | 共通        | ローカルでの作業が完了したら、リモートリポジトリにプッシュしてチームメンバーと共有します。            |

## 4. 品質基準とルール

### タスク完了の定義

`PROJECT_PLAN.md` のタスクが完了したと見なされるのは、以下の基準を全て満たした時です。

1.  **ビルド成功:** macOS と Linux の両方で `make` がエラーなく完了すること。
2.  **Norminette 準拠:** コード自体の Norm エラーが 0 であること。
3.  **動作確認済み:** 主要なテストケースで機能が正常に動作すること。
4.  **プッシュ完了:** 変更内容がリモートリポジトリに `git push` されていること。

### コメントの扱い

開発効率を上げるため、一時的なメモや未実装箇所に関するコメントを許容します。

- **形式:** `// TODO: [実装すべき内容]` または `// FIXME: [修正すべき問題]`
- **Norminette:** 上記のコメントが原因で発生する Norm エラーは、開発途中においては**許容**します。ただし、最終提出前にはクリーンナップすることが望ましいです。

### Git 運用ルール

- 作業が一段落したら、こまめに `push` して下さい。
- 作業前には必ず `pull` して下さい。
- `main`ブランチを基本として開発を進めます。

---

このフローに従い、計画的にプロジェクトを進めましょう。
